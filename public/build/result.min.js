/* 2016-12-20 / var fs=require("fs"),parse=require("csv-parse"),leftPad=require("left-pad"),c_meta=require("./node_geo.json"),tb_node_raw=fs.readFileSync("source/busan_tb_node_raw_1215.csv","utf8");parse(tb_node_raw,{comment:"#"},function(a,b){if(a)return console.log(a);console.log(b.length);for(var c=1;c<b.length;c+=1){var d=b[c],e=d[0],f=d[2].substring(0,10).split("-"),g=new Date(d[3]);""!==d[22],""===d[22]&&(d[22]=c_meta[d[0]].GEO_LAT),""===d[21]&&(d[21]=c_meta[d[0]].GEO_LON),console.log("%s, %s, %s, %s",d[0],d[3],d[22],d[21]);var h={event_time:g,node_id:e,event_type:d[1],measure_time:d[2],voltage:d[4],ampere:d[5],power_factor:d[6],active_power:d[7],reactive_power:d[8],apparent_power:d[9],amount_of_active_power:d[10],als_level:d[11],dimming_level:d[12],vibration_x:d[13],vibration_y:d[14],vibration_z:d[15],vibration_max:d[16],noise_origin_decibel:d[17],noise_origin_frequency:d[18],noise_decibel:d[19],noise_frequency:d[20],gps_longitude:d[21],gps_latitude:d[22],gps_altitude:d[23],gps_satellite_count:d[24],status_als:d[25],status_gps:d[26],status_noise:d[27],status_vibration:d[28],status_power_meter:d[29],status_emergency_led_active:d[30],status_self_diagnostics_led_active:d[31],status_active_mode:d[32],status_led_on_off_type:d[33],reboot_time:d[34],event_remain:d[35],failfirmwareupdate:d[36],node_geo:{lat:d[22],lon:d[21]}},i="corecode_"+f[0]+leftPad(f[1],2,"0")+leftPad(f[2],2,"0")+".log",j="data/"+i;1==c&&fs.existsSync(j)&&fs.truncateSync(j,0);var k=JSON.stringify(h)+"\n";fs.appendFileSync(j,k)}});for(var fs=require("fs"),parse=require("csv-parse"),sInfo=fs.readFileSync("source/corecode_info.json","utf8"),sLang=fs.readFileSync("source/station_lang.json","utf8"),sLocation=JSON.parse(sInfo).DATA,sNames=JSON.parse(sLang).DATA,location_meta=new Array,i=0;i<sLocation.length;i++)""===sLocation[i].XPOINT_WGS||"1"!==sLocation[i].LINE_NUM&&"2"!==sLocation[i].LINE_NUM&&"3"!==sLocation[i].LINE_NUM&&"4"!==sLocation[i].LINE_NUM&&"5"!==sLocation[i].LINE_NUM&&"6"!==sLocation[i].LINE_NUM&&"7"!==sLocation[i].LINE_NUM&&"8"!==sLocation[i].LINE_NUM&&"I"!==sLocation[i].LINE_NUM&&"B"!==sLocation[i].LINE_NUM||("서울"===sLocation[i].STATION_NM&&(sLocation[i].STATION_NM="서울역"),location_meta.push({STATION_NM:sLocation[i].STATION_NM,GEO_X:Number(sLocation[i].XPOINT_WGS),GEO_Y:Number(sLocation[i].YPOINT_WGS)}));for(var language_meta=new Object,i=0;i<sNames.length;i++)if(""!==sNames[i].STN_NM){var stn_name=sNames[i].STN_NM,qIndex=stn_name.indexOf("(");qIndex>0&&(stn_name=stn_name.substring(0,qIndex)),language_meta[stn_name]={STN_NM_KOR:sNames[i].STN_NM,STN_NM_CHC:sNames[i].STN_NM_CHC,STN_NM_ENG:sNames[i].STN_NM_ENG,STN_NM_CHN:sNames[i].STN_NM_CHN,STN_NM_JPN:sNames[i].STN_NM_JPN}}for(var station_meta=new Object,i=0;i<location_meta.length;i++){"총신대입구(이수)"===location_meta[i].STATION_NM?location_meta[i].STATION_NM="총신대입구":"쌍용(나사렛대)"===location_meta[i].STATION_NM?location_meta[i].STATION_NM="쌍용":"마전(무정차)"===location_meta[i].STATION_NM&&(location_meta[i].STATION_NM="마전");try{"광명"!==location_meta[i].STATION_NM&&"원흥"!==location_meta[i].STATION_NM&&"매탄권선"!==location_meta[i].STATION_NM&&(station_meta[location_meta[i].STATION_NM]={STN_NM:location_meta[i].STATION_NM,STN_NM_KOR:language_meta[location_meta[i].STATION_NM].STN_NM_KOR,STN_NM_CHC:language_meta[location_meta[i].STATION_NM].STN_NM_CHC,STN_NM_ENG:language_meta[location_meta[i].STATION_NM].STN_NM_ENG,STN_NM_CHN:language_meta[location_meta[i].STATION_NM].STN_NM_CHN,STN_NM_JPN:language_meta[location_meta[i].STATION_NM].STN_NM_JPN,GEO_X:location_meta[i].GEO_X,GEO_Y:location_meta[i].GEO_Y})}catch(a){}}module.exports=station_meta;